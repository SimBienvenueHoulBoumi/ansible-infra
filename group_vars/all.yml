# =============================================================================
# Source unique des variables GitOps – modifier ce fichier pour toute montée
# de version ou changement d’environnement (contexte, namespace, timeouts, etc.).
# =============================================================================

# -----------------------------------------------------------------------------
# Cluster Kubernetes
# -----------------------------------------------------------------------------
# Contexte à utiliser (kubectl config get-contexts)
kube_context: "kind-dev"

# Désactiver la vérification SSL (certificat API) quand accès depuis Docker
# (ex. host.docker.internal ; certificat souvent émis pour 127.0.0.1).
# Mettre true en production avec un vrai certificat.
k8s_validate_certs: false

# -----------------------------------------------------------------------------
# ArgoCD – installation Helm
# -----------------------------------------------------------------------------
argocd_namespace: "argocd"

# Nom du release Helm (changer si besoin pour cohabitation de versions)
argocd_helm_release_name: "argocd"

# Délai d’attente après install/upgrade Helm (augmenter en cas de montée de version lente)
argocd_helm_wait_timeout: "10m"

# -----------------------------------------------------------------------------
# ArgoCD – Applications déclaratives
# -----------------------------------------------------------------------------
# Serveur de destination par défaut pour les Application CRs
argocd_destination_server: "https://kubernetes.default.svc"

# Liste des applications à créer/mettre à jour (nom, repo, path, values, sync policy)
argocd_applications:
  - name: library-management
    namespace: default
    project: default
    repo_url: "https://github.com/SimBienvenueHoulBoumi/library_management_back.git"
    path: "kubernetes/charts/library-management"
    target_revision: "HEAD"
    helm_values:
      image:
        repository: "host.docker.internal:8083/repository/docker-hosted/simdev/library-management"
        tag: "latest"
    sync_policy:
      automated:
        prune: true
        selfHeal: true
      sync_options:
        - CreateNamespace=true
